<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Najdi 5 rozdílů</title>
  <style>
    :root{
      --bg:#f4f7fb;
      --card:#ffffff;
      --accent:#2b6cb0;
      --muted:#6b7280;
      --success:#16a34a;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial; background:linear-gradient(180deg,var(--bg),#eef4fb); color:#0f172a; display:flex;min-height:100vh;align-items:center;justify-content:center;padding:32px}
    .app{width:100%;max-width:1200px;background:var(--card);border-radius:16px;box-shadow:0 6px 30px rgba(11,24,40,0.08);padding:28px}
    header{display:flex;align-items:center;justify-content:space-between;gap:16px}
    h1{margin:0;font-size:clamp(18px,2.2vw,28px);color:var(--accent)}
    .controls{display:flex;gap:12px;align-items:center}
    .counter{font-weight:600;color:var(--muted)}
    .btn{background:var(--accent);color:#fff;padding:8px 14px;border-radius:10px;border:0;cursor:pointer;font-weight:600;box-shadow:0 6px 16px rgba(43,108,176,0.18)}
    .btn.secondary{background:transparent;color:var(--accent);border:1px solid rgba(43,108,176,0.12)}

    .play-area{display:flex;gap:18px;align-items:flex-start;justify-content:center;margin-top:20px}
    .image-card{position:relative;flex:1;max-width:600px}
    .image-card img{display:block;width:100%;height:auto;border-radius:12px;cursor:pointer;box-shadow:0 8px 18px rgba(11,24,40,0.06)}
    /* overlay that contains circles */
    .overlay{position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none}

    .marker{position:absolute;transform:translate(-50%,-50%);width:56px;height:56px;border-radius:50%;border:3px solid red;box-shadow:0 6px 18px rgba(0,0,0,0.15);display:flex;align-items:center;justify-content:center;pointer-events:none;opacity:0;scale:0.6}
    .marker.show{animation:pop 700ms cubic-bezier(.2,.9,.3,1) forwards}
    .marker .pulse{position:absolute;inset:0;border-radius:50%;opacity:0.12;background:radial-gradient(circle at center, red 10%, transparent 40%);animation:heartbeat 1200ms infinite ease-out}

    @keyframes pop{0%{opacity:0;transform:translate(-50%,-50%) scale(0.6)}60%{opacity:1;transform:translate(-50%,-50%) scale(1.08)}100%{opacity:1;transform:translate(-50%,-50%) scale(1)}}
    @keyframes heartbeat{0%{transform:scale(0.9);opacity:0.6}50%{transform:scale(1.05);opacity:0.95}100%{transform:scale(0.9);opacity:0.6}}

    .footer{margin-top:18px;text-align:center;color:var(--muted)}

    /* responsive: stack images on small screens */
    @media (max-width:900px){
      .play-area{flex-direction:column}
    }

    /* congrats modal */
    .modal{position:fixed;left:50%;top:50%;transform:translate(-50%,-50%) scale(0.9);background:linear-gradient(180deg,#fff,#f7feff);padding:26px;border-radius:14px;box-shadow:0 20px 60px rgba(8,17,34,0.2);display:none;min-width:260px;text-align:center}
    .modal.show{display:block;animation:modalIn 400ms cubic-bezier(.2,.9,.3,1) forwards}
    @keyframes modalIn{0%{opacity:0;transform:translate(-50%,-50%) scale(0.9)}100%{opacity:1;transform:translate(-50%,-50%) scale(1)}}

    .time{font-weight:600;color:var(--muted);}
  </style>
</head>
<body>
  <div class="app" role="application">
    <header>
      <h1>Najdi 5 rozdílů</h1>
      <div class="controls">
        <div class="counter" id="counter">Nalezeno: <span id="found">0</span>/5</div>
        <div class="time">Čas: <span id="timer">00:00</span></div>
        <button class="btn" id="restart">Začít znovu</button>
      </div>
    </header>

    <main class="play-area">
      <div class="image-card" data-side="left">
        <img id="imgLeft" src="https://raw.githubusercontent.com/eliskaksthov/samet/refs/heads/main/rozdil2.png" alt="levý obrázek - rozdíly" />
        <div class="overlay" id="ovLeft"></div>
      </div>

      <div class="image-card" data-side="right">
        <img id="imgRight" src="https://raw.githubusercontent.com/eliskaksthov/samet/refs/heads/main/rozdil1.jpg" alt="pravý obrázek - rozdíly" />
        <div class="overlay" id="ovRight"></div>
      </div>
    </main>

    <div class="footer">Klikni na obrázek, kde si myslíš, že vidíš rozdíl. Hledej všechny 5!</div>
  </div>

  <div class="modal" id="congrats" role="dialog" aria-modal="true">
    <h2>Gratulace!</h2>
    <p>Našel/a jsi všechny rozdíly za <strong id="finalTime"></strong>.</p>
    <button class="btn" id="closeCongrats">Zavřít</button>
  </div>

  <script>
    /*
      Differences array: x and y in percent of image width/height (0-100)
      tolerance in percent (of image width) to allow relaxed clicks.
      Upravit pozice podle potřeby. Tyto hodnoty odpovídají přibližným
      lokalitám na poskytnutých obrázcích.
    */
    const differences = [
      {id:1, x:31.5, y:23.5, tol:4}, // vlajka
      {id:2, x:62.0, y:30.0, tol:5}, // kabel/prázdno
      {id:3, x:6.5, y:62.0, tol:5},  // kříž u sochy
      {id:4, x:34.0, y:78.0, tol:5}, // plakát
      {id:5, x:31.0, y:95.0, tol:8}  // spodní tmavá oblast
    ];

    // game state
    let found = new Set();
    let startTime = null;
    let timerInterval = null;

    const imgLeft = document.getElementById('imgLeft');
    const imgRight = document.getElementById('imgRight');
    const ovLeft = document.getElementById('ovLeft');
    const ovRight = document.getElementById('ovRight');
    const foundEl = document.getElementById('found');
    const counterEl = document.getElementById('counter');
    const restartBtn = document.getElementById('restart');
    const timerEl = document.getElementById('timer');
    const congrats = document.getElementById('congrats');
    const finalTime = document.getElementById('finalTime');
    const closeCongrats = document.getElementById('closeCongrats');

    // Calculate click relative position (% of image)
    function getClickPercent(e, img){
      const rect = img.getBoundingClientRect();
      let cx = e.clientX - rect.left;
      let cy = e.clientY - rect.top;
      // clamp
      cx = Math.max(0, Math.min(rect.width, cx));
      cy = Math.max(0, Math.min(rect.height, cy));
      const xPercent = (cx / rect.width) * 100;
      const yPercent = (cy / rect.height) * 100;
      return {xPercent, yPercent, rect};
    }

    function startTimer(){
      startTime = Date.now();
      clearInterval(timerInterval);
      timerInterval = setInterval(()=>{
        const dt = Date.now() - startTime;
        timerEl.textContent = formatTime(dt);
      }, 200);
    }
    function stopTimer(){
      clearInterval(timerInterval);
    }
    function formatTime(ms){
      const s = Math.floor(ms/1000);
      const mm = Math.floor(s/60);
      const ss = s % 60;
      return String(mm).padStart(2,'0')+":"+String(ss).padStart(2,'0');
    }

    function checkClickOnImage(e, side){
      // determine which image clicked
      const img = side === 'left' ? imgLeft : imgRight;
      const ov = side === 'left' ? ovLeft : ovRight;
      const {xPercent,yPercent,rect} = getClickPercent(e,img);

      // if first click start timer
      if(!startTime) startTimer();

      // find if any dif matches and not already found
      for(const d of differences){
        if(found.has(d.id)) continue;
        // compute distance in percent relative to width
        const dx = xPercent - d.x;
        const dy = yPercent - d.y * (rect.height/rect.width) * 0 + 0; // keep dy in percent of height; to compare with tol in width percent, normalize
        // Better: convert percent to px to compute euclidean distance
        const pxX = (d.x/100) * rect.width;
        const pxY = (d.y/100) * rect.height;
        const clickX = (xPercent/100) * rect.width;
        const clickY = (yPercent/100) * rect.height;
        const dist = Math.hypot(pxX - clickX, pxY - clickY);
        // tolerance in pixels derived from tol% of width
        const tolPx = (d.tol/100) * rect.width;
        if(dist <= tolPx){
          // mark found
          markDifference(d, clickX/rect.width*100, clickY/rect.height*100);
          return true;
        }
      }
      // no match
      // optional: small shake animation on img to indicate miss
      img.animate([{transform:'translateY(0)'},{transform:'translateY(-6px)'},{transform:'translateY(0)'}],{duration:200,iterations:1});
      return false;
    }

    function markDifference(d, xPercent, yPercent){
      if(found.has(d.id)) return;
      found.add(d.id);
      foundEl.textContent = found.size;

      // create markers on both overlays at same relative position
      createMarker(ovLeft, d, xPercent, yPercent);
      createMarker(ovRight, d, xPercent, yPercent);

      // celebration animation pulse on counter
      counterEl.animate([{transform:'scale(1)'},{transform:'scale(1.08)'},{transform:'scale(1)'}],{duration:400,iterations:1});

      if(found.size >= differences.length){
        // game won
        stopTimer();
        finalTime.textContent = timerEl.textContent;
        setTimeout(()=>{
          congrats.classList.add('show');
        },400);
      }
    }

    function createMarker(overlay, d, xPercent, yPercent){
      const marker = document.createElement('div');
      marker.className = 'marker';
      marker.style.left = xPercent + '%';
      marker.style.top = yPercent + '%';
      marker.dataset.id = d.id;
      // inner pulse element
      const pulse = document.createElement('div');
      pulse.className = 'pulse';
      marker.appendChild(pulse);
      overlay.appendChild(marker);
      // trigger animation class after a tick
      requestAnimationFrame(()=> marker.classList.add('show'));
    }

    // attach click listeners on images
    function onImgClick(e){
      const side = e.currentTarget.parentElement.dataset.side;
      checkClickOnImage(e, side);
    }

    imgLeft.addEventListener('click', onImgClick);
    imgRight.addEventListener('click', onImgClick);

    restartBtn.addEventListener('click', resetGame);
    closeCongrats.addEventListener('click', ()=>{congrats.classList.remove('show'); resetGame();});

    function resetGame(){
      found.clear();
      foundEl.textContent = '0';
      // clear overlays
      ovLeft.innerHTML = '';
      ovRight.innerHTML = '';
      // reset timer
      startTime = null;
      timerEl.textContent = '00:00';
      stopTimer();
      congrats.classList.remove('show');
      // optionally shuffle differences or keep same positions
      // small visual effect
      document.querySelector('.app').animate([{opacity:0.92,transform:'scale(0.995)'},{opacity:1,transform:'scale(1)'}],{duration:300,iterations:1});
    }

    // for keyboard / accessibility: allow clicking via Enter on image when focused
    imgLeft.tabIndex = 0; imgRight.tabIndex = 0;
    imgLeft.addEventListener('keydown', (e)=>{ if(e.key==='Enter') checkClickOnImage(e,'left');});
    imgRight.addEventListener('keydown', (e)=>{ if(e.key==='Enter') checkClickOnImage(e,'right');});

    // initial reset
    resetGame();

    // --- Optional: show rough debug guides (comment out in production) ---
    // function showDebug(){
    //   for(const d of differences){
    //     const mk=document.createElement('div');mk.style.position='absolute';mk.style.left=d.x+'%';mk.style.top=d.y+'%';mk.style.width='10px';mk.style.height='10px';mk.style.background='rgba(255,0,0,0.7)';mk.style.borderRadius='50%';ovLeft.appendChild(mk);ovRight.appendChild(mk.cloneNode(true));
    //   }
    // }
    // showDebug();
  </script>
</body>
</html>
